Вывести всех людей с КТУ, чье отчество встречается более 50ти раз.
SELECT "Н_ЛЮДИ"."ИМЯ", "Н_ЛЮДИ"."ФАМИЛИЯ" FROM "Н_ЛЮДИ" WHERE ("Н_ЛЮДИ"."ИД" in (
SELECT "ЧЛВК_ИД" FROM "Н_ОБУЧЕНИЯ" WHERE )

SELECT "Н_ЛЮДИ"."ИМЯ", "Н_ЛЮДИ"."ФАМИЛИЯ" FROM "Н_ЛЮДИ" as ppl JOIN
	(SELECT studs."ЧЛВК_ИД"
		FROM "Н_УЧЕНИКИ" AS studs join (

		))

  JOIN "Н_НАПРАВЛЕНИЯ_СПЕЦИАЛ" ON "Н_ПЛАНЫ"."НАПС_ИД" = "Н_НАПРАВЛЕНИЯ_СПЕЦИАЛ"."ИД"
  JOIN "Н_НАПР_СПЕЦ" ON "Н_НАПР_СПЕЦ"."ИД" = "Н_НАПРАВЛЕНИЯ_СПЕЦИАЛ"."НС_ИД"
    AND "Н_НАПР_СПЕЦ"."НАИМЕНОВАНИЕ" = 'КТУ'





    SELECT "Н_ЛЮДИ"."ИМЯ", "Н_ЛЮДИ"."ФАМИЛИЯ" FROM "Н_ЛЮДИ" WHERE "Н_ЛЮДИ"."ИД" IN (SELECT "Н_УЧЕНИКИ"."ЧЛВК_ИД" FROM "Н_УЧЕНИКИ" WHERE "ПЛАН_ИД" IN (SELECT "Н_ПЛАНЫ"."ИД" FROM "Н_ПЛАНЫ" WHERE "НАПС_ИД" IN (SELECT "Н_НАПРАВЛЕНИЯ_СПЕЦИАЛ"."НАПС_ИД" FROM "Н_НАПРАВЛЕНИЯ_СПЕЦИАЛ" WHERE "НС_ИД" IN (SELECT "ИД" FROM "Н_НАПР_СПЕЦ" as spec WHERE spec."НАИМЕНОВАНИЕ" = 'КТиУ'))));

    SELECT "Н_ЛЮДИ"."ИМЯ", "Н_ЛЮДИ"."ФАМИЛИЯ" FROM "Н_ЛЮДИ" JOIN (SELECT "Н_УЧЕНИКИ"."ЧЛВК_ИД" FROM "Н_УЧЕНИКИ" WHERE "ПЛАН_ИД" IN (SELECT "Н_ПЛАНЫ"."ИД" FROM "Н_ПЛАНЫ" WHERE "НАПС_ИД" IN (SELECT "Н_НАПРАВЛЕНИЯ_СПЕЦИАЛ"."НАПС_ИД" FROM "Н_НАПРАВЛЕНИЯ_СПЕЦИАЛ" WHERE "НС_ИД" IN (SELECT "ИД" FROM "Н_НАПР_СПЕЦ" as spec WHERE spec."НАИМЕНОВАНИЕ" = 'КТиУ')))) studs ON "Н_ЛЮДИ"."ИД" = "Н_УЧЕНИКИ"."ЧЛВК_ИД";

     SELECT "Н_ЛЮДИ"."ИМЯ", "Н_ЛЮДИ"."ФАМИЛИЯ" FROM "Н_ЛЮДИ" JOIN "Н_УЧЕНИКИ" ON "Н_УЧЕНИКИ"."ЧЛВК_ИД" = "Н_ЛЮДИ"."ИД" WHERE (SELECT "Н_УЧЕНИКИ"."ЧЛВК_ИД" FROM "Н_УЧЕНИКИ" WHERE "ПЛАН_ИД" IN (SELECT "Н_ПЛАНЫ"."ИД" FROM "Н_ПЛАНЫ" WHERE "НАПС_ИД" IN (SELECT "Н_НАПРАВЛЕНИЯ_СПЕЦИАЛ"."НАПС_ИД" FROM "Н_НАПРАВЛЕНИЯ_СПЕЦИАЛ" WHERE "НС_ИД" IN (SELECT "ИД" FROM "Н_НАПР_СПЕЦ" as spec WHERE spec."НАИМЕНОВАНИЕ" = 'КТиУ'))));

     SELECT "Н_ЛЮДИ"."ИМЯ", "Н_ЛЮДИ"."ФАМИЛИЯ" FROM "Н_ЛЮДИ" JOIN "Н_УЧЕНИКИ" ON "Н_УЧЕНИКИ"."ЧЛВК_ИД" = "Н_ЛЮДИ"."ИД" WHERE "ПЛАН_ИД" IN (SELECT "Н_ПЛАНЫ"."ИД" FROM "Н_ПЛАНЫ" WHERE "НАПС_ИД" IN (SELECT "Н_НАПРАВЛЕНИЯ_СПЕЦИАЛ"."НАПС_ИД" FROM "Н_НАПРАВЛЕНИЯ_СПЕЦИАЛ" WHERE "НС_ИД" IN (SELECT "ИД" FROM "Н_НАПР_СПЕЦ" as spec WHERE spec."НАИМЕНОВАНИЕ" = 'Мехатроника')));



 SELECT CONCAT(Н_ЛЮДИ.ИМЯ, ' ', Н_ЛЮДИ.ФАМИЛИЯ, ' ', Н_ЛЮДИ.ОТЧЕСТВО) AS "ФИО"
  FROM Н_ЛЮДИ
  WHERE "ОТЧЕСТВО" IN (SELECT "ОТЧЕСТВО", COUNT("ОТЧЕСТВО") FROM "Н_ЛЮДИ" WHERE COUNT("ОТЧЕСТВО") > 50 AND
  Н_ЛЮДИ.ИД NOT IN (
    SELECT Н_УЧЕНИКИ.ЧЛВК_ИД
    FROM Н_УЧЕНИКИ
    JOIN Н_ПЛАНЫ ON Н_УЧЕНИКИ.ПЛАН_ИД = Н_ПЛАНЫ.ИД
    JOIN Н_ОТДЕЛЫ ON Н_ПЛАНЫ.ОТД_ИД = Н_ОТДЕЛЫ.ИД
      AND Н_ОТДЕЛЫ.КОРОТКОЕ_ИМЯ = 'КТиУ')
  GROUP BY Н_ЛЮДИ.ИМЯ, Н_ЛЮДИ.ФАМИЛИЯ, Н_ЛЮДИ.ОТЧЕСТВО;

  having COUNT("ОТЧЕСТВО") < 50;

  WHERE "ОТЧЕСТВО" IN (SELECT "ФАМИЛИЯ", COUNT("ФАМИЛИЯ") FROM "Н_ЛЮДИ" WHERE COUNT > 50);



select  "ИМЯ", "ФАМИЛИЯ", "ОТЧЕСТВО", count("ОТЧЕСТВО")
from "Н_ЛЮДИ" as ppl join
    (select studs."ЧЛВК_ИД" as person_id
    from "Н_УЧЕНИКИ" as studs join
        (select plans."ИД" as plan_id
        from "Н_ПЛАНЫ" as plans join "Н_ОТДЕЛЫ" as deps
        on (plans."ОТД_ИД" = deps."ИД" and
            deps."КОРОТКОЕ_ИМЯ" = 'КТиУ')) KTUPlans
    on studs."ПЛАН_ИД" = KTUPlans.plan_id) KTUStuds
on ppl."ИД" = KTUStuds.person_id
group by "ИМЯ", "ФАМИЛИЯ", "ОТЧЕСТВО"
having count("ОТЧЕСТВО") > 50;



select "ИМЯ", "ФАМИЛИЯ", "ОТЧЕСТВО" from "Н_ЛЮДИ" ppl join
(select "ОТЧЕСТВО" father_name, count("ОТЧЕСТВО") from "Н_ЛЮДИ" KTUPpl join
(select studs."ЧЛВК_ИД" as person_id
    from "Н_УЧЕНИКИ" as studs join
        (select plans."ИД" as plan_id
        from "Н_ПЛАНЫ" as plans join "Н_ОТДЕЛЫ" as deps
        on (plans."ОТД_ИД" = deps."ИД" and
            deps."КОРОТКОЕ_ИМЯ" = 'КТиУ')) KTUPlans
    on studs."ПЛАН_ИД" = KTUPlans.plan_id) KTUStuds
on KTUStuds.person_id = KTUppl."ИД"
group by "ОТЧЕСТВО"
having count("ОТЧЕСТВО") > 50) father_names
on ppl."ОТЧЕСТВО" = father_name;
